import{r as c,j as t}from"./index-Cr8WPmXE.js";function g(){const[p,y]=c.useState(""),[n,r]=c.useState(null),[i,l]=c.useState(null),[d,o]=c.useState(!1),[a,u]=c.useState({}),h=[{label:"員工 ID",key:"emp_id",type:"text"},{label:"國家代碼",key:"country_code",type:"text"},{label:"員工姓名",key:"emp_name",type:"text"},{label:"開始日期",key:"start_date",type:"date"},{label:"大使姓名",key:"ambassador_name",type:"text"}],m=async()=>{try{const s=await(await fetch(`php/employeeposting_search.php?emp_id=${p}`)).json();o(!1),s.error==="none"?(r(null),l("查無此人，是否新增？")):s.error==="delete"?(setCountry(null),l("此員工已刪除")):(r(s),l(null))}catch(e){console.error("查詢失敗",e),l("查詢失敗，請稍後再試")}},x=()=>{o(!0),u({...n})},j=()=>{for(let e of h){const s=a[e.key];if(s===void 0||s==="")return alert("所有欄位均為必填"),!1}return!0},b=async()=>{if(!j())return;const e=n?"php/employeeposting_update.php":"php/employeeposting_add.php";try{(await(await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json()).success?(r(a),o(!1),alert(n?"資料更新成功":"新增成功")):alert(n?"資料更新失敗":"新增失敗")}catch(s){console.error("操作失敗",s),alert(n?"資料更新失敗，請稍後再試":"新增失敗，請稍後再試")}},f=async()=>{try{(await(await fetch(`php/employeeposting_delete.php?emp_id=${p}`)).json()).success?(r(null),l("查無此人"),alert("員工資料已刪除")):alert("刪除失敗")}catch(e){console.error("刪除失敗",e),alert("刪除失敗，請稍後再試")}},k=()=>{r(null),l(null),o(!0),u({emp_id:p,country_code:"",emp_name:"",start_date:"",ambassador_name:"",is_delete:0})};return t.jsxs("div",{children:[t.jsx("h1",{children:"查詢派駐資料"}),t.jsx("input",{type:"text",value:p,onChange:e=>y(e.target.value),placeholder:"輸入員工身分證字號"}),t.jsx("button",{onClick:m,children:"查詢"}),i&&t.jsxs("div",{children:[t.jsx("p",{style:{color:"red",fontSize:"24px",fontWeight:"bold"},children:i}),i.includes("是否新增")&&t.jsx("button",{onClick:k,children:"新增員工"})]}),(n||d)&&t.jsxs("div",{children:[t.jsx("h2",{children:d?"新增 / 編輯員工資料":"員工資料"}),d?t.jsxs("div",{children:[h.map(e=>t.jsxs("p",{children:[e.label,":"," ",t.jsx("input",{type:e.type,value:a[e.key]||"",onChange:s=>u({...a,[e.key]:s.target.value})})]},e.key)),t.jsx("button",{onClick:b,children:n?"保存":"新增"}),t.jsx("button",{onClick:()=>o(!1),children:"取消"})]}):t.jsxs("div",{children:[h.map(e=>t.jsxs("p",{children:[e.label,": ",n[e.key]]},e.key)),t.jsx("button",{onClick:x,children:"編輯"}),t.jsx("button",{onClick:f,children:"刪除"})]})]})]})}export{g as default};
